@using CkgDomainLogic.Feinstaub.Models
@model FeinstaubSuchparameter

@{ var formID = 1; }

@using (Html.BeginDiv("formbereich", id: MvcAjaxOptions.AjaxFormContainerName + formID))
{
     using (Ajax.BeginForm("LoadVergabeInfos", "Feinstaub", null,
                           new MvcAjaxOptions(formID) { OnComplete = "ShowVergabeInfos();" }))
     {
            @Html.ValidationSummary()
            
            @Html.FormTextBlockFor(m => m.ErfassungsdatumHint, cssClass: "Percent90Width TextAlignRight", labelCssClass: null)
            @Html.FormNewLine()

            @Html.FormTextBoxFor(m => m.KennzeichenTeil1, cssClass: "FormTextboxSmallS", additionalHtmlAttributes: new Dictionary<string, object>() { { "maxlength", 3 } })
            @Html.FormLabel("-", cssClass: "top10")
            @Html.FormTextBoxFor(m => m.KennzeichenTeil2, cssClass: "FormTextboxSmallW", labelCssClass: null, additionalHtmlAttributes: new Dictionary<string, object>() { { "maxlength", 6 } })
            @Html.FormNewLine()

            @Html.FormDatePickerFor(m => m.ErfassungsdatumVon)
            @Html.FormDatePickerFor(m => m.ErfassungsdatumBis)
            @Html.FormNewLine()
            
            @Html.FormDivLinie()

         <div class="floatLeft textboxRight">
             <input type="submit" value="Suchen" class="submitbutton" />
         </div>

         <script type="text/javascript">
             _modelStateValid = '@ViewContext.ViewData.ModelState.IsValid.ToString().ToLower()';
         </script>
     }
}

<script type="text/javascript">

    function ShowVergabeInfos() {
        FormPreparePrivateAjax();

        if (_modelStateValid == 'true') {
            $.ajax({
                type: "POST",
                url: "ShowVergabeInfos",
                success: function(result) {
                    ShowFeinstaubSearchResult(result);
                }
            });
        }
    }

</script>