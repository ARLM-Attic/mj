@model CkgDomainLogic.Uebfuehrg.ViewModels.UebfuehrgViewModel

<style type="text/css">

</style>

<script type="text/javascript">

    var _modelIsValid = false;

    function FormPreparePrivate() {

        try { FormWizardInitPrivate(); } catch (e) { }

    };

    function FormPreparePrivateAjax() {
        FormPrepareAjax();
        $('.tooltips').tooltip();
    }

    function FormWizardInitPrivate() {
        FormWizard.Init(function () {
            
        });

        FormWizard.OnNext(function (step, maxSteps) {

            var ajaxFormID = "#AjaxForm" + (step - 2);
            $(ajaxFormID).submit();
            return false;

        });

        FormWizard.OnPrev(function (step, maxSteps) {
            return true;
        });

        FormWizard.OnSubmit(function () {

            AjaxRequestNextStep();

            return true;
        });

        FormWizard.OnBackToSummary(function () {

            //FormWizard.ButtonBackToSummaryShow(false);
            FormWizard.ButtonNextShow(true);
            $("#AjaxForm" + FormWizard.getCurrentIndex()).submit();

            return true;
        });

        FormWizard.OnRestart(function () {
            location.reload();
        });
    }

    function AjaxFormComplete() {
        FormPrepareAjax();
        if (_modelIsValid) {
            if (FormWizard.buttonVisible("backtosummary")) {
                var uiIndex = 4;
                $("#formWizardStep_" + (uiIndex + 1)).find("a").trigger("click");
                FormWizard.ButtonBackToSummaryShow(false);
            } else
                AjaxRequestNextStep();
        }
        
        try {
            var detailWindow = $("#Adressen").data("tWindow");
            detailWindow.center().close();
        } catch(e) {
        }
    }

    function AjaxRequestNextStep() {
        $.ajax({
            type: "POST",
            url: "NextStepView",
            data: {},
            loadingShow: true,
            success: function (result) {
                if (typeof (result.message) !== "undefined") {
                    alert(result.message);
                    return;
                }

                FormWizard.SetNextTabHtmlAndMoveNext(result);
            }
        });
    }


    //    
    // <Adressen common>
    //

    function AjaxFormAdressePrepareAutoCompleteReset(uiIndex) {
        var form = $("#AjaxForm" + uiIndex);
        form.find("input:text").each(function () {
            if ($(this).attr('name') != 'Name1')
                $(this).bind('keyup', function () { $("#AjaxForm" + uiIndex + " input[name='Name1']").autocomplete("disable"); });
        });
    }

    function AjaxFormAdressePrepareAutoComplete(tb, url) {

        var form = tb.closest("form");
        var textboxValues = '';
        form.find("input:text").each(function () {
            if ($(this).attr('name') != 'Name1')
                textboxValues = $(this).val();
        });
        if (textboxValues != '')
            return;

        $.ajax({
            type: "POST",
            url: url,
            data: {},
            loadingShow: false,
            success: function (result) {
                AjaxFormAdresseInitAutoComplete(tb, result.items);
            }
        });
    }

    function AjaxFormAdresseInitAutoComplete(tb, items) {
        tb.autocomplete({
            minLength: 0,
            source: items,
            select: function (event, ui) {
                //alert(ui.item.value);
                var form = tb.closest("form");
                $("#" + form.attr("id") + " input[name='TmpSelectionKey']").val(ui.item.value);
                form.submit();
            }
        });
        tb.autocomplete("enable");
    }

    function AjaxFormAdresseEmpty(formID, url) {
        var form = $("#" + formID);
        form.find(":input").each(function () {
            switch (this.type) {
                case 'password':
                case 'select-multiple':
                case 'text':
                case 'textarea':
                    $(this).val('');
                    break;
                case 'select-one':
                    $(this).val('DE');
                    break;
                case 'checkbox':
                case 'radio':
                    this.checked = false;
            }
        });

        AjaxFormAdressePrepareAutoComplete($("#" + formID + " input[name='Name1']"), url);
        return false;
    }

    function SummaryStepDataEdit(uiIndex) {

        $.ajax(
            {
                type: "POST",
                url: "SummaryStepDataEdit",
                data: { uiIndex: uiIndex },
                loadingShow: false,
                success: function () {
                    $("#formWizardStep_" + (uiIndex + 1)).find("a").trigger("click");
                    FormWizard.ButtonNextShow(false);
                    FormWizard.ButtonBackToSummaryShow(true);
                }
            });

        return false;
    }

    function AjaxFormAdresseClose() {
        $("#AdresseBearbeiten").data("tWindow").close();
    }

    function GridAdresseOnSelect(id, formID, addressType) {

        var form = $("#" + formID);

        if (typeof (form.attr('id')) != 'undefined') {
            AjaxFormAdresseClose();
            $("#Adressen").data("tWindow").close();
            $("#" + formID + " input[name='TmpSelectionKey']").val(id);
            form.submit();
        }
    }

    //    
    // </Adressen common>
    //


    //    
    // <UebfuehrgAdressen>
    //

    function OnDataBound_UebfuehrgAdressenAuswahlGrid() {
        FilteredData_Grid_OnDataBound($(this));
        $('.tooltips').tooltip();
    }

    function OnColumnShowHide_UebfuehrgAdressenAuswahlGrid() {
        FilteredData_Grid_OnColumnShowHide($(this));
    }

    function OnColumnReorder_UebfuehrgAdressenAuswahlGrid() {
        FilteredData_Grid_OnColumnReorder($(this));
    }

    function OnComplete_UebfuehrgAdressenAuswahlGrid() {
        var grid = $(this);
        setTimeout(function () {
            var gridHeight = parseInt(grid.css('height').replace(/px/, ""));
            var newHeight = (gridHeight + 80) + 'px';
            grid.closest('.t-window-content').animate({ height: newHeight }, 200); // .css('height', newHeight);
        }, 300);
    }

    //    
    // </UebfuehrgAdressen>
    //
    
</script>


@(Html.Telerik().Window()
    .Name("Adressen")
    .Visible(false)
    .Title("Auswahl Adressen")
    .Modal(true)
    .Draggable(true)
    .Scrollable(false)
    .Width(900)
    .Height(700)
    .Content(@<text><div id="InnerAdressen"></div></text>))


@(Html.Telerik().Window()
    .Name("AdresseBearbeiten")
    .Visible(false)
    .Title("Adresse bearbeiten")
    .Modal(true)
    .Draggable(true)
    .Scrollable(false)
    .Width(500)
    .Height(550)
    .Content(@<text><div id="InnerAdresseBearbeiten"></div></text>))
