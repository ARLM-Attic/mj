@using CkgDomainLogic.Finance.Models
@model MahnstopEdit

<div id="DivMahnstopEdit" class="margin-top-20">
    @using (Ajax.BeginForm("MahnstopEditForm", "Finance", null,
                           new MvcAjaxOptions { UpdateTargetId = "DivMahnstopEdit", OnComplete = "AjaxFormMahnstopEditComplete();" },
                           htmlAttributes: new { @class = "form-horizontal", id = "MahnstopEditAjaxForm" }))
    {
        @Html.HiddenFor(m => m.EquiNr)
        @Html.HiddenFor(m => m.MaterialNr)
        @Html.HiddenFor(m => m.PAID)

        <h4 class="margin-bottom-25">
            @Localize.DunningStopEdit
        </h4>

        @Html.FormValidationSummary()

        @Html.FormCheckBoxFor(m => m.Mahnsperre)        
        @Html.FormDatePickerFor(m => m.MahnstopBis, new { @class = "m-wrap small" })
        @Html.FormTextAreaFor(m => m.Bemerkung, new { @class = "m-wrap" }, null, 40, 3)

        <div class="space20"></div>
        
        <div class="form-actions">
            <button type="submit" class="btn green"><i class="icon-ok"></i> @Localize.Apply</button>
            <button type="button" class="btn" onclick="AjaxFormMahnstopEditClose();">@Localize.Cancel</button>
        </div>

        <script type="text/javascript">
            _modelStateValid = '@ViewContext.ViewData.ModelState.IsValid.ToString().ToLower()';
        </script>
    }
</div>

<script type="text/javascript">

    function AjaxFormMahnstopEditComplete() {      
        $.ajax(
        {
            type: "POST",
            url: "MahnstopEditComplete",
            loadingShow: true,
            success: function (result) {
                if (_modelStateValid == 'true') {
                    ApplyMahnstopsGridPartialView(result);
                    AjaxFormMahnstopEditClose();
                }
            }
        });
    }

</script>