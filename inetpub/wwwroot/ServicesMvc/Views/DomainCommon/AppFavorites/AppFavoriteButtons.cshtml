@using CkgDomainLogic.General.Contracts
@{ var logonContext = (ILogonContextDataService)SessionHelper.GetSessionObject("LogonContext"); }

<h4 class="margin-top-30 margin-bottom-25">
        
    @Localize.YourFavorites
        
    @if (!logonContext.AppFavoritesEditMode)
    {
        <a href="#" class="btn white app-favorite-on-homepage-command tooltips" onclick="return AppFavoritesEditSwitch();" data-original-title="Favoriten bearbeiten ..." data-placement="right">
            <i class="icon-pencil"></i>
        </a>
    }
</h4>

@if (logonContext.AppFavoritesEditMode)
{
    <script type="text/javascript">
        var infoMessage =
        setTimeout(function () {
            SpanAlertWarning("AppFavoritesEditMode", infoMessage, 999999);
        }, 1000);
    </script>
    
    <div class="alert alert-success app-favorite-on-homepage-edit-mode-hint">
        <i class="icon-info-sign"></i> 
        <span>
            Sie befinden sich nun Bearbeitungs-Modus für Ihre Homepage Favoriten.<br />
            <ul>
                <li>Wählen Sie links aus dem Menü Ihre Favoriten aus - oder wieder ab.</li>
                <li>
                    Hier verlassen Sie den Bearbeitungs-Modus:         
                    <a href="#" class="btn green margin-left-10" onclick="return AppFavoritesEditSwitch();"><i class="icon-ok"></i></a>
                </li>
            </ul>
        </span>
    </div>
}
    
<style type="text/css">
    a.app-favorite {
        color: white!important;
        font-weight: bold!important;
    }
    
    a.app-favorite-on-homepage-command {
        background-color: white!important;
    }
    a.app-favorite-on-homepage {
        width: 200px;
        margin-right: 30px;
        margin-bottom: 20px;
    }
    .group-favorite-on-homepage {
        color: #606060;
    }

    .app-favorite-on-homepage-edit-mode-hint i {
        margin-right: 10px;
        font-size: 1.4em;
    }
    .app-favorite-on-homepage-edit-mode-hint ul li {
        font-weight: normal!important;
        list-style: circle;
        margin-left: 28px!important;
    }
</style>

<script type="text/javascript">

    function FormPreparePrivate() {
        $(".tooltips").tooltip();
    }
    
    function AppFavoritesEditSwitch() {
        $.ajax({
            type: "POST",
            url: "DomainCommon/AppFavoritesEditModeSwitch",
            data: { },
            loadingShow: false,
            success: function (result) {
                location.reload();
            },
            error: function (jqXhr) {
            }
        });

        return false;
    }
    
    function AppFavoriteButtonsCoreRefresh() {
        $.ajax({
            type: "POST",
            url: "DomainCommon/AppFavoriteButtonsCoreRefresh",
            data: {},
            loadingShow: false,
            success: function (result) {
                $("#AppFavoriteButtonsCore").html(result);
            },
            error: function (jqXhr) {
            }
        }); 
    }

    function AppFavoritesEditSwitchOneFavorite(a, appID) {
        $.ajax({
            type: "POST",
            url: "DomainCommon/AppFavoritesEditSwitchOneFavorite",
            data: { appID: appID },
            loadingShow: false,
            success: function (result) {
                if (result.isFavorite)
                    $(a).addClass("app-favorite");
                else
                    $(a).removeClass("app-favorite");

                AppFavoriteButtonsCoreRefresh();
            },
            error: function (jqXhr) {
            }
        });

        return false;
    }

</script>

<div id="AppFavoriteButtonsCore">
    @Html.Partial("AppFavorites/AppFavoriteButtonsCore", logonContext)
</div>


