
<style type="text/css">
    .grid-column-overall-quick-filter-pick-cancel .text {
        margin-left: 5px;
        font-weight: bold;
        color: black!important;
    }
</style>

<div class="GridAllColumnFilter hide">
    <div>
        <div class="grid-toolbar">
            <!-- Paging Size -->
            <div class="dataTables_length">
                <label>
                    <select class="grid-page-sizer" size="1">
                        <option value="5">5</option>
                        <option value="10" selected="selected">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="200">200</option>
                    </select> 
                    <div class="grid-rows-per-page-label">
                        <span class="smartphone-inline">@Localize.RowsToShowSmall</span>
                        <span class="tablet-or-wider-inline">@Localize.RowsToShow</span>
                    </div>
                </label>
            </div>
            
            <!-- Tools, export options, etc -->
            <div class="outer-export-menu btn-group pull-right margin-left-15">
				<button class="btn dropdown-toggle" data-toggle="dropdown">Export <i class="icon-angle-down"></i></button>
				<ul class="dropdown-menu pull-right">
				    <li><a class="outer-export-link-excel" href="#"><i class="menu-item excel-export">Excel</i></a></li>
					<li><a class="outer-export-link-pdf" href="#"><i class="menu-item pdf-export">PDF</i></a></li>
				</ul>
			</div>

            <!-- Overall Column Filter -->
            <div class="dataTables_filter smartphone">
                <label>@Localize.ColumnOverallFilterSmall: <input type="text" class="grid-column-overall-filter"></label>
            </div>
            <div class="dataTables_filter tablet-or-wider">
                <label>@Localize.ColumnOverallFilter: <input type="text" class="grid-column-overall-filter"></label>
            </div>
            <div class="dataTables_filter tablet-or-wider margin-right-10 margin-top-5">
                
                <button class="grid-column-overall-quick-filter-pick-start btn grey mini tooltips" onclick="GridAllColumnFilterQuickMouseClickFilterSwapPickingMode()" 
                        data-original-title="Filtertext per Maus auswählen! Wählen Sie Ihren Filtertext per Mausklick aus einer beliebigen Zelle im Grid." data-placement="top">
                    <i class='halflings-icon filter'></i><i class='halflings-icon magnet'></i>
                </button>
                <button class="grid-column-overall-quick-filter-pick-cancel btn red mini tooltips hide" onclick="GridAllColumnFilterQuickMouseClickFilterSwapPickingMode()" 
                        data-original-title="Abbrechen! (Filtertext per Maus auswählen abbrechen)" data-placement="top">
                        <i class='halflings-icon filter'></i><i class='halflings-icon magnet'></i> <span class="text"> Abbrechen</span>
                </button>

                <button class="grid-column-overall-quick-filter-reset btn blue mini tooltips hide" onclick="GridAllColumnFilterQuickMouseClickFilterReset()"
                        data-original-title="Filtertext zurücksetzen" data-placement="top">
                    <i class='halflings-icon filter'></i><i class='halflings-icon remove'></i>
                </button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    
    function GridAllColumnFilterApplyToGrid(gridName, exportExcelAndPdfAvailable) {

        var columnFilter = $(".GridAllColumnFilter");

        $("#" + gridName + " > .t-grid-toolbar").append(columnFilter.html());

        // build grid export menu (excel + pdf)
        if (typeof (exportExcelAndPdfAvailable) == 'undefined')
            exportExcelAndPdfAvailable = true;
        if (!exportExcelAndPdfAvailable)
            $("#" + gridName + " .outer-export-menu").hide();

        // build grid page sizer
        $("#" + gridName + " .grid-page-sizer").change(function () {
            var grid = $("#" + gridName).data("tGrid");
            grid.pageSize = $(this).val();
            grid.pageTo(1);
        });

        FilterGridInit(gridName);
    }

    var _gridAllColumnFilterQuickMouseClickFilter_isActive = false;
    function GridAllColumnFilterQuickMouseClickFilterReset() {
        $(".grid-column-overall-filter").val("");
        FilterGridAllColumns($(".grid-column-overall-filter"));
        $(".grid-column-overall-quick-filter-reset").hide();
    }

    function GridAllColumnFilterQuickMouseClickFilterSwapPickingMode() {
        _gridAllColumnFilterQuickMouseClickFilter_isActive = !_gridAllColumnFilterQuickMouseClickFilter_isActive;

        if (_gridAllColumnFilterQuickMouseClickFilter_isActive) {
            $(".grid-column-overall-quick-filter-pick-start").hide();
            $(".grid-column-overall-quick-filter-pick-cancel").show();
        } else {
            $(".grid-column-overall-quick-filter-pick-start").show();
            $(".grid-column-overall-quick-filter-pick-cancel").hide();
        }

        if (_gridAllColumnFilterQuickMouseClickFilter_isActive) {

            $(".t-grid table td")
                .css("cursor", "crosshair")
                .on("click",
                    function () {
                        $(".grid-column-overall-filter").val($(this).text());
                        FilterGridAllColumns($(".grid-column-overall-filter"));
                        $(".grid-column-overall-quick-filter-reset").show();
                        $(this).removeClass("red");
                        GridAllColumnFilterQuickMouseClickFilterSwapPickingMode();
                    })
                .hover(
                    function () {
                        $(this).addClass("red");
                    },
                    function () {
                        $(this).removeClass("red");
                    }
                );

        } else {
            $(".t-grid table td").off("click").unbind("hover").css("cursor", "default");
        }

        return false;
    }
    
    function TrySetOuterExportLink(grid, exportLink, href, exportType) {
        if (href.toLowerCase().indexOf(exportType) == -1)
            return;

        var gridElement = $(grid.element);
        var outerExportLink = gridElement.find('.outer-export-link-' + exportType);
        if (outerExportLink != null) {
            outerExportLink.attr('href', href);
        }
    }
    
</script>